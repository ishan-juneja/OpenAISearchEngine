# OpenAISearchEngine - Clinical Trial Embeddings and Similarity Search

This project processes clinical trial data to identify relevant trials based on user queries, utilizing embeddings generated by OpenAI's API. The code performs data loading, embedding generation, and similarity comparison using cosine similarity to recommend clinical trials related to a specified query.

## Features

- **OpenAI API Embeddings**: Generates text embeddings using the `text-embedding-ada-002` model.
- **Parallel Embedding Generation**: Utilizes threading to optimize embedding generation for large datasets.
- **Cosine Similarity Search**: Calculates the similarity between user query embeddings and clinical trial embeddings.
- **Error Handling**: Manages API rate limits and query length validation.

## Requirements

- Python 3.x
- OpenAI Python SDK
- Pandas
- NumPy
- Scikit-learn

## Setup

1. **Install dependencies**:

   ```bash
   pip install openai pandas numpy scikit-learn
Environment Setup:

Ensure your OpenAI API key is set. Replace API_KEY in the code with your actual API key or load it securely from environment variables.

Usage
1. Load and Process Clinical Trial Data
The script loads data from a CSV file containing clinical trial information with columns like NCT ID, Conditions, Criterion, and Study Link. Ensure your data is in the same format.

2. Generate Embeddings
Embeddings are generated for each clinical trial's Conditions text. Embeddings are used to compare trials with user queries based on cosine similarity.

3. Run the Program
Run the script using a sample CSV file and query:

csv_file_path = "clinical_trials_Georgia_data_complete.csv"
user_query = "What studies have inclusion and exclusion criteria related to cancer in older adults?"
results = main(csv_file_path, user_query)
print(results)
The script will output the top 3 most relevant clinical trials based on cosine similarity.

## Functions
get_embedding(text): Fetches embeddings for text using OpenAIâ€™s API.
load_trials(csv_file): Loads clinical trials data from a CSV file.
create_embeddings(trial_text): Creates an embedding for each trial's criteria text.
generate_trial_embeddings(trials_df): Generates embeddings for all trials in the dataset in parallel.
process_query(query): Validates and generates an embedding for the user query.
find_relevant_trials(query_embedding, trials_df): Finds trials with the highest similarity to the query.
manage_api_rate_limit(calls_made): Ensures API calls do not exceed set limits.
